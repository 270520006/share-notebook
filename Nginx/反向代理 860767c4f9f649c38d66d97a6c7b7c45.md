# 反向代理

## 了解反向代理之前我们先来了解一下什么是正向代理

> Nginx不仅可以做反向代理,实现负载均衡。还能用做正向代理来实现上网功能。正向代理如果把局域网外的Internet想象成一个巨大的资源库,则局域网内的客户端要访问Internet,则需要通过代理服务器来访问,这种代理服务器就称为正向代理

## 反向代理

> 我们需要将请求发送到反向代理服务器,由方向代理服务器获取数据后,在返回给客户端,此时反向代理服务器和目标服务器对外就是一个整体的服务器,暴露的是代理服务器地址,隐藏了真实服务器IP地址

## 配置反向代理访问Tomcat的主页面

1. 安装配置Tomcat
2. 访问的过程
3. 修改本地HOST文件,配置域名绑定IP 
    1. HOST路径地址: C:\Windows\System32\drivers\etc
    2. 在下面最后一行配置 你的LinuxIP加上空格和你自定义的域名  192.168.230.140 www.test.com
4. 在nginx.con文件中配置 server_name 为Linux 服务器IP,在Location块中配置 proxy_pass [http://127.0.0.1:8080](http://127.0.0.1:8080) 也就是Tomcat的服务器地址

### 配置反向代理根据不同的访问路径访问不同的tomcat

- 首先我们要准备2个Tomcat
- 配置nginx.conf   在 Nginx配置文件中配置Serve块信息配置
    - Server块信息配置

        ![%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%20860767c4f9f649c38d66d97a6c7b7c45/Untitled.png](%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%20860767c4f9f649c38d66d97a6c7b7c45/Untitled.png)

    - location 指令配置说明
        - location  = ~ ~* ^~       URI{}
            1. = 用于不含正则表达式的  URI 前,要求请求字符串与 URI 严格匹配,如果配置成功,就停止继续向下搜索并立即处理该请求。
            2. ~ 用于表示 URI 包含正则表达式,并且区分大小写
            3. ~* 用于表示 URI 包含正则表达式,并且不区分大小写
            4. ^~ 用于不含正则表达式的 URI 前要求Nginx服务器找到标识 URI 和请求字符串匹配度最高的location之后,立即使用此location处理请求,而不再使用location块中正则 URI 和请求字符串做匹配。
            5. **注意:如果 URI 包含正则表达式,则必须要由 ~ 或 ~*的标识**。