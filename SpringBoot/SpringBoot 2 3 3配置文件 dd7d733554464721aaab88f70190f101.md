# SpringBoot 2.3.3配置文件

# Springboot能够解析的配置文件有 application.proterties 和  application.yml

- spring boot默认推荐使用yml文件 yml文件很强大支持给对象属性赋值
- 可以使用@ConfigurationProperties 注解与yml文件相关联 就是将配置文件 yml中的每一个属性的值一个个映射到组件中 ，来告诉spring boot将本类中的所有属性和配置文件中的所有配置进行绑定 做法:使用@ConfigurationProperties的 prefix=“xxx" 将配置文件中的对象下的属性一一对应
- 只有这个组件是容器中的组件，才能使用容器所提供的@configurationProperties功能

## 使用这个注解之前可以配置springboot的依赖和插件，或不配置spingboot的依赖插件

```xml
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-configuration-processor</artifactId>
    <optional>true</optional>
</dependency>
<plugins>
            <plugin>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-maven-plugin</artifactId>
                <configuration>
                    <excludes>
                        <exclude>
                            <groupId>org.springframework.boot</groupId>
                            <artifactId>spring-boot-configuration-processor</artifactId>
                        </exclude>
                    </excludes>
                </configuration>
            </plugin>
        </plugins>
```

@Configuration 和 @Value对比

- ConfigurationProperties 只需要写一次即可, value 则需要每个字段都添加
- 松散绑定的意思:比如我在yml使用的是last-name这个和lastName是一样的 - 后跟的字母是大写的，这就是松散绑定
- jsr303数据校验,这个就是我们可以在字段增加一层过滤器验证，可以保证数据的合法性
- 复杂类型封装，yml可以封装对象，使用@value就不支持

总结:

- 配置yml配置和properties配置都可以获取到值，强烈推荐使用yml
- 如果我们在某个业务中，只需要获取配置文件中的某个值，可以使用一下@value
- 如果说,我们专门编写了一个配置文件和Java Bean来和配置文件进行映射,直接使用@ConfigurationProperties,不要犹豫

---

# JSR303数据校验

### 导入依赖

```xml
				<dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-validation</artifactId>
        </dependency>
```

![SpringBoot%202%203%203%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%20dd7d733554464721aaab88f70190f101/Untitled.png](SpringBoot%202%203%203%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%20dd7d733554464721aaab88f70190f101/Untitled.png)

![SpringBoot%202%203%203%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%20dd7d733554464721aaab88f70190f101/Snipaste_2020-09-22_11-00-33.png](SpringBoot%202%203%203%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%20dd7d733554464721aaab88f70190f101/Snipaste_2020-09-22_11-00-33.png)

# 自动装配的原理

1. Springboot会加载并启动大量的自动配置类
2. 我们要看我们的功能有没有在SpringBoot默认写好的自动配置类中
3. 我们再来看这些自动配置类中,到底配置了那些组件,只要我们要用的组件存在其中,我们就不需要手动配置
4. 给容器中配置自动配置类添加组件的时候,会从properties类获取某些属性,我们只需要在配置文件(yml or properties)种指定这些属性即可  XXXAutoConfiguration自动配置类 给容器中添加组件  —→XXXProperties封装配置文件中的属性,然后就可以通过yml配置文件修改Properties的属性值