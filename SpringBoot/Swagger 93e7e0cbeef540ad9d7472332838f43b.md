# Swagger

Introduction:Simplify API development for users, teams, and enterprises with the Swagger open source and professional toolset. Find out how Swagger can help you design and document your APIs at scale

利用Swagger开源和专业的工具来帮助用户,团队和企业,来简化API开发,了解Swagger怎么样帮助我们进行大规模的设计和记录

## 学习目标

- 了解swagger的作用和概念
- 了解后端分离
- 在SpringBoot中继承swagger

## Swagger简介

### 前后端分离:

Vue+SpringBoot

后端时代:前端只用管理静态页面；html⇒后端，模板引擎  jsp⇒后端主力

### 前后端分离时代

- 后端:后端控制陈,服务层,数据访问层【后端】
- 前端:前端控制层,视图层 【前端团队】
    - 伪造后端数据,使用 json封装数据,不需要后端传入数据,前端工程依然可以正常运行
- 不需要后端怎么进行数据交互呢?  ⇒使用 api接口
- 前后端**相对**独立,松耦合架构
- 前后端甚至可以部署到不同的服务器上

## 但是前后端分离又会诞生一个问题

- 前后端继承联调,前后端无法及时做到,”即使协商,尽早解决“

## 解决方案

- 指定一个schema 【计划图解,提纲】,实时更新Api
- 早些年,怎么解决呢？使用word的文档
    - 前后端分离
- 使用前端测试后端的接口工具 如 postman
- 后端提供接口,需要实时更新最新的消息及改动

# Swagger

- 号称世界上最流行的Api框架
    - RestFul API 风格  API文档在线自动生成工具 ⇒ **API文档和API同时更新**
    - 直接运行,在线测试API接口
    - 支持多总语言 like java php ...

### 官方网址 [https://swagger.io/](https://swagger.io/)

# 怎么在项目中使用Swagger:

- swagger2
- ui

## SpringBoot集成Swagger

- 新建一个SpringWeb项目
- 导入相关依赖

```xml
<!-- https://mvnrepository.com/artifact/io.springfox/springfox-swagger2 -->
<dependency>
    <groupId>io.springfox</groupId>
    <artifactId>springfox-swagger2</artifactId>
    <version>2.9.2</version>
</dependency>
<!-- https://mvnrepository.com/artifact/io.springfox/springfox-swagger-ui -->
<dependency>
    <groupId>io.springfox</groupId>
    <artifactId>springfox-swagger-ui</artifactId>
    <version>2.9.2</version>
</dependency>
```

- 配置Swagger

```java
/**
 * @author Administrator
 * 开启swagger
 */
@Configuration
@EnableSwagger2
public class SwaggerConfig {
}
```

- 访问swagger  ui界面  [http://127.0.0.1:8080/swagger-ui.html](http://127.0.0.1:8080/swagger-ui.html)

![Swagger%2093e7e0cbeef540ad9d7472332838f43b/Untitled.png](Swagger%2093e7e0cbeef540ad9d7472332838f43b/Untitled.png)

## 配置Swagger扫描指定接口过滤请求

- 使用 Docket()对象下的select()方法来自定义API请求

```java
package com.sky.boot.config;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.core.env.Environment;
import org.springframework.core.env.Profiles;
import springfox.documentation.builders.RequestHandlerSelectors;
import springfox.documentation.service.ApiInfo;
**import springfox.documentation.service.Contact;**
import springfox.documentation.service.VendorExtension;
import springfox.documentation.spi.DocumentationType;
import springfox.documentation.spring.web.plugins.Docket;
import springfox.documentation.swagger2.annotations.EnableSwagger2;

import java.util.ArrayList;

/**
 * @author Administrator
 * 开启swagger
 */
@Configuration
@EnableSwagger2
public class SwaggerConfig {

    /**
     * 初始化作者信息
     * 设置作者名称,url,和邮箱地址
     */
    private static final Contact DEFAULT_CONTACT = new Contact("刘富贵", "http://www.adsencehutter.com/", "2677672@gmail.com");

    @Bean
    public Docket docket(Environment environment) {
        // 设置指定当前应用程序的的运行环境
        Profiles profiles = Profiles.of("dev", "test");
        // 判断当前运行环境是否为接受profile设置的环境
        boolean flag = environment.acceptsProfiles(profiles);
        return new Docket(DocumentationType.SWAGGER_2)
                .groupName("富贵")
                .apiInfo(getApiInfo())

                // enable() 是否启用Swagger默认为true,如果为false,则在浏览器中不能访问Swagger
                .enable(flag)
                .select()
                // apis() 根据接口来进行过滤 RequestHandlerSelectors 配置请求选择处理器,扫描接口的方式

                // basePackage()  指定特定的路径去构建指定的接口
                // .apis(RequestHandlerSelectors.basePackage("com.sky.boot.controller"))
                // any() 请求处理选择器处理所有的接口
                // .apis(RequestHandlerSelectors.any())
                // none() 请求处理器不处理任何接口
                // .apis(RequestHandlerSelectors.none())
                // withClassAnnotation() 请求处理器处理标注了指定的注解的类下的API接口
                .apis(RequestHandlerSelectors.any())
                // withMethodAnnotation() 请求处理器处理标注了指定的注解的方法下的API接口
                // .apis(RequestHandlerSelectors.withMethodAnnotation(GetMapping.class))
                // paths() 设置指定的路径下,来进行过滤  PathSelectors 配置路径选择器

                // ant() 过滤指定路径
                // .paths(PathSelectors.ant("/controller/**"))
                // none() 不配置任何路径
                // .paths(PathSelectors.none())
                // none() 配置所有的路径
                // .paths(PathSelectors.any())
                // regex() 根据正则表达式来配置路径
                // .paths(PathSelectors.regex(""))
                .build();
    }

    public ApiInfo getApiInfo() {
        return new ApiInfo("刘富贵的Swagger", "无可匹敌的力量", "6.0", "urn:tos",
                DEFAULT_CONTACT, "Apache 2.0", "http://www.onmyway.cf/", new ArrayList<VendorExtension>());
    }
}
```

 

## 配置swagger API分组

使用 groupName("组名");

## 配置多个分组

配置多个Docket()对象即可,组名必须与其他不相同

## SwaggerAPI注解

- Swagger提供了很多API注解用来解释被Swagger处理的请求,只要当请求被处理的时候这些API接口才会生效
- 我们可以通过Swagger给一些难以理解的属性或者接口增加注释信息 好处:接口文档实时更新,可以在线测试

## 注意点  【在正式上线关闭Swagger,出于安全考虑,还可以节省内存】

**注意:如果你的项目配置好了swagger,还是404找不到,请看一下你swagger的版本,适当降低swagger或spring boot的版本**